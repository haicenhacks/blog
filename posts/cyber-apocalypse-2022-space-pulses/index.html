<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Cyber Apocalypse 2022 - Space Pulses | haicen.me</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Haicen">
<link rel="prev" href="../cyber-apocalypse-2022-blinkerfluids/" title="Cyber Apocalypse 2022 - Blinkerfluids" type="text/html">
<link rel="next" href="../configuring-custom-headers-for-owasp-zap/" title="Configuring custom headers for OWASP ZAP" type="text/html">
<meta property="og:site_name" content="haicen.me">
<meta property="og:title" content="Cyber Apocalypse 2022 - Space Pulses">
<meta property="og:url" content="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/">
<meta property="og:description" content="This challenge was part of the hardware category, and was pretty interesting.
Here is the challenge description:

One of our enhanced radio telescopes captured some weird fluctuations from a nearby st">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-05-30T12:34:49-04:00">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://blog.haicen.me/">

                <span id="blog-title">haicen.me</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>
                </li>
<li>
<a href="../../rss.xml">RSS feed</a>
                </li>
<li>
<a href="../../pages/about-me">Contact Me</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Cyber Apocalypse 2022 - Space Pulses</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Haicen
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2022-05-30T12:34:49-04:00" itemprop="datePublished" title="2022-05-30 12:34">2022-05-30 12:34</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>This challenge was part of the hardware category, and was pretty interesting.
Here is the challenge description:</p>
<blockquote>
<p>One of our enhanced radio telescopes captured some weird fluctuations from a nearby star. It was idle for decades due to the fact that it was fully enclosed by a Dyson Sphere but its patterns began to change drastically leading us to believe that someone is controlling part of the megastructure to release energy and send these pulses directed to us in order to transmit a message. They must have known that our equipment can read even the slightest fluctuations.</p>
</blockquote>
<p>There was a downloadable file, which was a saleae logic file.
This definitely isn't something easy like serial.
It seems like it might have some time dependent information encoded, because the pulse time is not consistent.
I started to suspect this might be some sort of pulse width modulation encoding scheme.</p>
<img alt="/images/space_pulses/initial.png" src="../../images/space_pulses/initial.png"><p>First, I exported the signal from Logic2 as a CSV so I could work with it.
I started by plotting the time each pulse was on vs off.
I knew the time was in seconds, so the pulse times would be small.</p>
<div class="code"><pre class="code python"><a id="rest_code_aa8d1eb922484912a86e7b9ace733066-1" name="rest_code_aa8d1eb922484912a86e7b9ace733066-1" href="#rest_code_aa8d1eb922484912a86e7b9ace733066-1"></a><span class="n">iimport</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<a id="rest_code_aa8d1eb922484912a86e7b9ace733066-2" name="rest_code_aa8d1eb922484912a86e7b9ace733066-2" href="#rest_code_aa8d1eb922484912a86e7b9ace733066-2"></a><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<a id="rest_code_aa8d1eb922484912a86e7b9ace733066-3" name="rest_code_aa8d1eb922484912a86e7b9ace733066-3" href="#rest_code_aa8d1eb922484912a86e7b9ace733066-3"></a>
<a id="rest_code_aa8d1eb922484912a86e7b9ace733066-4" name="rest_code_aa8d1eb922484912a86e7b9ace733066-4" href="#rest_code_aa8d1eb922484912a86e7b9ace733066-4"></a><span class="n">sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">'sp_digital.txt'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="rest_code_aa8d1eb922484912a86e7b9ace733066-5" name="rest_code_aa8d1eb922484912a86e7b9ace733066-5" href="#rest_code_aa8d1eb922484912a86e7b9ace733066-5"></a><span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sig</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">1000</span>
<a id="rest_code_aa8d1eb922484912a86e7b9ace733066-6" name="rest_code_aa8d1eb922484912a86e7b9ace733066-6" href="#rest_code_aa8d1eb922484912a86e7b9ace733066-6"></a>
<a id="rest_code_aa8d1eb922484912a86e7b9ace733066-7" name="rest_code_aa8d1eb922484912a86e7b9ace733066-7" href="#rest_code_aa8d1eb922484912a86e7b9ace733066-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_aa8d1eb922484912a86e7b9ace733066-8" name="rest_code_aa8d1eb922484912a86e7b9ace733066-8" href="#rest_code_aa8d1eb922484912a86e7b9ace733066-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="rest_code_aa8d1eb922484912a86e7b9ace733066-9" name="rest_code_aa8d1eb922484912a86e7b9ace733066-9" href="#rest_code_aa8d1eb922484912a86e7b9ace733066-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'signal_plot.png'</span><span class="p">)</span>
<a id="rest_code_aa8d1eb922484912a86e7b9ace733066-10" name="rest_code_aa8d1eb922484912a86e7b9ace733066-10" href="#rest_code_aa8d1eb922484912a86e7b9ace733066-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
<p>That produced the following output:</p>
<img alt="/images/space_pulses/signal_plot.png" src="../../images/space_pulses/signal_plot.png"><p>That pretty much confirmed my suspicions that this was PWM.
The time delta does not exceed 255 for any pulse, so that seems like it may be an ascii encoded string.
Let's convert it.</p>
<div class="code"><pre class="code python"><a id="rest_code_cf23cc74d10145f4b4d052d7630a2205-1" name="rest_code_cf23cc74d10145f4b4d052d7630a2205-1" href="#rest_code_cf23cc74d10145f4b4d052d7630a2205-1"></a><span class="n">rounded_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">values</span><span class="p">[::</span><span class="mi">2</span><span class="p">])</span>
<a id="rest_code_cf23cc74d10145f4b4d052d7630a2205-2" name="rest_code_cf23cc74d10145f4b4d052d7630a2205-2" href="#rest_code_cf23cc74d10145f4b4d052d7630a2205-2"></a><span class="n">floor_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">values</span><span class="p">[::</span><span class="mi">2</span><span class="p">])</span>
<a id="rest_code_cf23cc74d10145f4b4d052d7630a2205-3" name="rest_code_cf23cc74d10145f4b4d052d7630a2205-3" href="#rest_code_cf23cc74d10145f4b4d052d7630a2205-3"></a><span class="n">ceil_values</span> <span class="o">=</span> <span class="n">int_values</span> <span class="o">+</span> <span class="mi">1</span>
<a id="rest_code_cf23cc74d10145f4b4d052d7630a2205-4" name="rest_code_cf23cc74d10145f4b4d052d7630a2205-4" href="#rest_code_cf23cc74d10145f4b4d052d7630a2205-4"></a>
<a id="rest_code_cf23cc74d10145f4b4d052d7630a2205-5" name="rest_code_cf23cc74d10145f4b4d052d7630a2205-5" href="#rest_code_cf23cc74d10145f4b4d052d7630a2205-5"></a><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">rounded_values</span><span class="p">,</span> <span class="n">floor_values</span><span class="p">,</span> <span class="n">ceil_values</span><span class="p">]:</span>
<a id="rest_code_cf23cc74d10145f4b4d052d7630a2205-6" name="rest_code_cf23cc74d10145f4b4d052d7630a2205-6" href="#rest_code_cf23cc74d10145f4b4d052d7630a2205-6"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]))</span>
</pre></div>
<p>I did not know whether my floating point values from the time delta should be rounded, floored, or ceiling-ed, so I did all 3.
My script output the following:</p>
<pre class="literal-block">Dppsejobuft!.!SB!2:i!69n!33t!}!Efd!,46+!23(!7((!.!Wbmjebujpo!tfdsfu!dpef;!IUC|qv2646`n1ev2582o:`2o`6q5d4"63&amp;~
Coordinates - RA 19h 58m 22s | Dec +35* 12' 6'' - Validation secret code: HTB{pu1535_m0du1471n9_1n_5p4c3!52%}
Dppsejobuft!.!SB!2:i!69n!33t!}!Efd!,46+!23(!7((!.!Wbmjebujpo!tfdsfu!dpef;!IUC|qv2646`n1ev2582o:`2o`6q5d4"63&amp;~</pre>
<p>The only one that produced reasonable output was floor. The flag is in the last half of the message.</p>
<p>The full script is below:</p>
<div class="code"><pre class="code python"><a id="rest_code_11434ad937fb41caaf38362cf6bd9ef8-1" name="rest_code_11434ad937fb41caaf38362cf6bd9ef8-1" href="#rest_code_11434ad937fb41caaf38362cf6bd9ef8-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a id="rest_code_11434ad937fb41caaf38362cf6bd9ef8-2" name="rest_code_11434ad937fb41caaf38362cf6bd9ef8-2" href="#rest_code_11434ad937fb41caaf38362cf6bd9ef8-2"></a><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<a id="rest_code_11434ad937fb41caaf38362cf6bd9ef8-3" name="rest_code_11434ad937fb41caaf38362cf6bd9ef8-3" href="#rest_code_11434ad937fb41caaf38362cf6bd9ef8-3"></a>
<a id="rest_code_11434ad937fb41caaf38362cf6bd9ef8-4" name="rest_code_11434ad937fb41caaf38362cf6bd9ef8-4" href="#rest_code_11434ad937fb41caaf38362cf6bd9ef8-4"></a><span class="n">sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">'sp_digital.txt'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="rest_code_11434ad937fb41caaf38362cf6bd9ef8-5" name="rest_code_11434ad937fb41caaf38362cf6bd9ef8-5" href="#rest_code_11434ad937fb41caaf38362cf6bd9ef8-5"></a><span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sig</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">1000</span>
<a id="rest_code_11434ad937fb41caaf38362cf6bd9ef8-6" name="rest_code_11434ad937fb41caaf38362cf6bd9ef8-6" href="#rest_code_11434ad937fb41caaf38362cf6bd9ef8-6"></a>
<a id="rest_code_11434ad937fb41caaf38362cf6bd9ef8-7" name="rest_code_11434ad937fb41caaf38362cf6bd9ef8-7" href="#rest_code_11434ad937fb41caaf38362cf6bd9ef8-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_11434ad937fb41caaf38362cf6bd9ef8-8" name="rest_code_11434ad937fb41caaf38362cf6bd9ef8-8" href="#rest_code_11434ad937fb41caaf38362cf6bd9ef8-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="rest_code_11434ad937fb41caaf38362cf6bd9ef8-9" name="rest_code_11434ad937fb41caaf38362cf6bd9ef8-9" href="#rest_code_11434ad937fb41caaf38362cf6bd9ef8-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'signal_plot.png'</span><span class="p">)</span>
<a id="rest_code_11434ad937fb41caaf38362cf6bd9ef8-10" name="rest_code_11434ad937fb41caaf38362cf6bd9ef8-10" href="#rest_code_11434ad937fb41caaf38362cf6bd9ef8-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="rest_code_11434ad937fb41caaf38362cf6bd9ef8-11" name="rest_code_11434ad937fb41caaf38362cf6bd9ef8-11" href="#rest_code_11434ad937fb41caaf38362cf6bd9ef8-11"></a>
<a id="rest_code_11434ad937fb41caaf38362cf6bd9ef8-12" name="rest_code_11434ad937fb41caaf38362cf6bd9ef8-12" href="#rest_code_11434ad937fb41caaf38362cf6bd9ef8-12"></a><span class="n">rounded_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">values</span><span class="p">[::</span><span class="mi">2</span><span class="p">])</span>
<a id="rest_code_11434ad937fb41caaf38362cf6bd9ef8-13" name="rest_code_11434ad937fb41caaf38362cf6bd9ef8-13" href="#rest_code_11434ad937fb41caaf38362cf6bd9ef8-13"></a><span class="n">int_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">values</span><span class="p">[::</span><span class="mi">2</span><span class="p">])</span>
<a id="rest_code_11434ad937fb41caaf38362cf6bd9ef8-14" name="rest_code_11434ad937fb41caaf38362cf6bd9ef8-14" href="#rest_code_11434ad937fb41caaf38362cf6bd9ef8-14"></a><span class="n">ceil_values</span> <span class="o">=</span> <span class="n">int_values</span> <span class="o">+</span> <span class="mi">1</span>
<a id="rest_code_11434ad937fb41caaf38362cf6bd9ef8-15" name="rest_code_11434ad937fb41caaf38362cf6bd9ef8-15" href="#rest_code_11434ad937fb41caaf38362cf6bd9ef8-15"></a>
<a id="rest_code_11434ad937fb41caaf38362cf6bd9ef8-16" name="rest_code_11434ad937fb41caaf38362cf6bd9ef8-16" href="#rest_code_11434ad937fb41caaf38362cf6bd9ef8-16"></a><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">rounded_values</span><span class="p">,</span> <span class="n">int_values</span><span class="p">,</span> <span class="n">ceil_values</span><span class="p">]:</span>
<a id="rest_code_11434ad937fb41caaf38362cf6bd9ef8-17" name="rest_code_11434ad937fb41caaf38362cf6bd9ef8-17" href="#rest_code_11434ad937fb41caaf38362cf6bd9ef8-17"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]))</span>
</pre></div>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../cyber-apocalypse-2022-blinkerfluids/" rel="prev" title="Cyber Apocalypse 2022 - Blinkerfluids">Previous post</a>
            </li>
            <li class="next">
                <a href="../configuring-custom-headers-for-owasp-zap/" rel="next" title="Configuring custom headers for OWASP ZAP">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2023         <a href="mailto:haicenhack@protonmail.com">Haicen</a> 
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
